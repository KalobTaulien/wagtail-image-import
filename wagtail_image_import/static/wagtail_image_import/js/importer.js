!function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t){function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=window.React,c=window.ReactDOM,l=window.wagtail.components.Icon;function u(e){return a.createElement(s,{appId:e.appId,pickerApiKey:e.pickerApiKey,clientId:e.clientId,scope:"https://www.googleapis.com/auth/documents.readonly https://www.googleapis.com/auth/drive.readonly"})}function s(e){var t=r(a.useState(!1),2),i=t[0],o=t[1];function c(e,t,n){return e.type==google.picker.Type.PHOTO}function l(e,t,n){return e.type==google.picker.Type.jG}function u(e){if(e.action==google.picker.Action.PICKED){var t=e.docs.filter(c),r=e.docs.filter(l),i=new Array;if(r){var o="(mimeType contains 'image/') and (".concat(r.reduce((function(e,t){return e+"('".concat(t.id,"' in parents) or ")}),"").slice(0,-4),")");gapi.client.drive.files.list({q:o,pageSize:1e3,fields:"nextPageToken, files(id, name, thumbnailLink, fileExtension, md5Checksum, size, imageMediaMetadata)"}).then((function(e){i.push.apply(i,n(e.result.files))}))}t&&t.forEach((function(e){gapi.client.drive.files.get({fileId:e.id,fields:"id, name, thumbnailLink, fileExtension, md5Checksum, size, imageMediaMetadata"}).then((function(e){i.push(e.result)}))}))}}return a.useEffect((function(){gapi.load("client:auth2:picker",(function(){gapi.client.init({apiKey:e.pickerApiKey,clientId:e.clientId,discoveryDocs:["https://docs.googleapis.com/$discovery/rest?version=v1","https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:e.scope}).then((function(){o(!0)})).catch((function(e){console.error(e)}))}))}),[]),i?a.createElement("button",{class:"button bicolor icon icon-plus",onClick:function(){var t;(t=gapi.auth2.getAuthInstance(),t.isSignedIn.get()?Promise.resolve(t.currentUser.get().getAuthResponse()):t.signIn({scope:e.scope}).then((function(e){return e.getAuthResponse()}))).then((function(t){return n=t.access_token,r=u,(i=new google.picker.DocsView(google.picker.ViewId.DOCS_IMAGES)).setSelectFolderEnabled(!0),i.setIncludeFolders(!0),i.setParent("root"),void(new google.picker.PickerBuilder).setAppId(e.appId).enableFeature(google.picker.Feature.MULTISELECT_ENABLED).setDeveloperKey(e.pickerApiKey).setOAuthToken(n).addView(i).setCallback(r).build().setVisible(!0);var n,r,i}))}},"Select an image or folder in Drive"):a.createElement(p,{message:"Loading Google API"})}var p=function(e){return a.createElement("span",null,a.createElement(l,{name:"spinner",className:"c-spinner"}),e.message)},d=document.querySelector("#importer");c.render(a.createElement(u,{appId:d.dataset.appId,pickerApiKey:d.dataset.pickerApiKey,clientId:d.dataset.clientId}),d)}]);